==========================================
SLURM_JOB_ID = 27798235
SLURM_JOB_NODELIST = a03-01
TMPDIR = /tmp/SLURM_27798235
==========================================
Requirement already satisfied: accelerate==1.1.1 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 1)) (1.1.1)
Requirement already satisfied: aiohappyeyeballs==2.4.3 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 2)) (2.4.3)
Requirement already satisfied: aiohttp==3.11.2 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 3)) (3.11.2)
Requirement already satisfied: aiosignal==1.3.1 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 4)) (1.3.1)
Requirement already satisfied: attrs==24.2.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 5)) (24.2.0)
Requirement already satisfied: bitsandbytes==0.42.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 6)) (0.42.0)
Requirement already satisfied: certifi==2024.8.30 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 7)) (2024.8.30)
Requirement already satisfied: charset-normalizer==3.4.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 8)) (3.4.0)
Requirement already satisfied: datasets==3.1.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 9)) (3.1.0)
Requirement already satisfied: dill==0.3.8 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 10)) (0.3.8)
Requirement already satisfied: einops==0.8.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 11)) (0.8.0)
Requirement already satisfied: filelock==3.16.1 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 12)) (3.16.1)
Requirement already satisfied: frozenlist==1.5.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 13)) (1.5.0)
Requirement already satisfied: fsspec==2024.9.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 14)) (2024.9.0)
Requirement already satisfied: huggingface-hub==0.26.2 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 15)) (0.26.2)
Requirement already satisfied: idna==3.10 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 16)) (3.10)
Requirement already satisfied: Jinja2==3.1.4 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 17)) (3.1.4)
Requirement already satisfied: MarkupSafe==3.0.2 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 18)) (3.0.2)
Requirement already satisfied: mpmath==1.3.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 19)) (1.3.0)
Requirement already satisfied: multidict==6.1.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 20)) (6.1.0)
Requirement already satisfied: multiprocess==0.70.16 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 21)) (0.70.16)
Requirement already satisfied: networkx==3.4.2 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 22)) (3.4.2)
Requirement already satisfied: numpy==2.1.3 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 23)) (2.1.3)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 24)) (12.1.3.1)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 25)) (12.1.105)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 26)) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 27)) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 28)) (9.1.0.70)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 29)) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 30)) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 31)) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 32)) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.20.5 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 33)) (2.20.5)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.4.127 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 34)) (12.4.127)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 35)) (12.1.105)
Requirement already satisfied: packaging==24.2 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 36)) (24.2)
Requirement already satisfied: pandas==2.2.3 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 37)) (2.2.3)
Requirement already satisfied: peft==0.13.2 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 38)) (0.13.2)
Requirement already satisfied: propcache==0.2.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 39)) (0.2.0)
Requirement already satisfied: psutil==6.1.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 40)) (6.1.0)
Requirement already satisfied: pyarrow==18.0.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 41)) (18.0.0)
Requirement already satisfied: python-dateutil==2.9.0.post0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 42)) (2.9.0.post0)
Requirement already satisfied: pytz==2024.2 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 43)) (2024.2)
Requirement already satisfied: PyYAML==6.0.2 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 44)) (6.0.2)
Requirement already satisfied: regex==2024.11.6 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 45)) (2024.11.6)
Requirement already satisfied: requests==2.32.3 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 46)) (2.32.3)
Requirement already satisfied: safetensors==0.4.5 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 47)) (0.4.5)
Requirement already satisfied: setuptools==75.3.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 48)) (75.3.0)
Requirement already satisfied: six==1.16.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 49)) (1.16.0)
Requirement already satisfied: sympy==1.13.1 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 50)) (1.13.1)
Requirement already satisfied: tokenizers==0.20.3 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 51)) (0.20.3)
Requirement already satisfied: torch==2.4.1 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 52)) (2.4.1)
Requirement already satisfied: tqdm==4.67.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 53)) (4.67.0)
Requirement already satisfied: transformers==4.46.2 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 54)) (4.46.2)
Requirement already satisfied: triton==3.0.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 55)) (3.0.0)
Requirement already satisfied: typing_extensions==4.12.2 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 56)) (4.12.2)
Requirement already satisfied: tzdata==2024.2 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 57)) (2024.2)
Requirement already satisfied: urllib3==2.2.3 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 58)) (2.2.3)
Requirement already satisfied: xxhash==3.5.0 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 59)) (3.5.0)
Requirement already satisfied: yarl==1.17.2 in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 60)) (1.17.2)
Requirement already satisfied: scipy in ./venv/lib/python3.12/site-packages (from bitsandbytes==0.42.0->-r requirements.txt (line 6)) (1.14.1)

[notice] A new release of pip is available: 24.0 -> 24.3.1
[notice] To update, run: pip install --upgrade pip
Requirement already satisfied: flash-attn in ./venv/lib/python3.12/site-packages (2.7.0.post2)
Requirement already satisfied: torch in ./venv/lib/python3.12/site-packages (from flash-attn) (2.4.1)
Requirement already satisfied: einops in ./venv/lib/python3.12/site-packages (from flash-attn) (0.8.0)
Requirement already satisfied: filelock in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (3.16.1)
Requirement already satisfied: typing-extensions>=4.8.0 in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (4.12.2)
Requirement already satisfied: sympy in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (1.13.1)
Requirement already satisfied: networkx in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (3.4.2)
Requirement already satisfied: jinja2 in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (3.1.4)
Requirement already satisfied: fsspec in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (2024.9.0)
Requirement already satisfied: setuptools in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (75.3.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.20.5 in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (2.20.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (12.1.105)
Requirement already satisfied: triton==3.0.0 in ./venv/lib/python3.12/site-packages (from torch->flash-attn) (3.0.0)
Requirement already satisfied: nvidia-nvjitlink-cu12 in ./venv/lib/python3.12/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch->flash-attn) (12.4.127)
Requirement already satisfied: MarkupSafe>=2.0 in ./venv/lib/python3.12/site-packages (from jinja2->torch->flash-attn) (3.0.2)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in ./venv/lib/python3.12/site-packages (from sympy->torch->flash-attn) (1.3.0)

[notice] A new release of pip is available: 24.0 -> 24.3.1
[notice] To update, run: pip install --upgrade pip
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.69s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:09<00:04,  4.67s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:13<00:00,  4.56s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:13<00:00,  4.59s/it]
Map:   0%|          | 0/2636 [00:00<?, ? examples/s]Map:   0%|          | 0/2636 [00:02<?, ? examples/s]Map:   0%|          | 0/2636 [00:02<?, ? examples/s]
Traceback (most recent call last):
  File "/project/swabhas_1457/ctli/cm/544-nlp-project/official_finetuning/finetune.py", line 138, in <module>
    main()
  File "/project/swabhas_1457/ctli/cm/544-nlp-project/official_finetuning/finetune.py", line 111, in main
    dataset = dataset.map(
              ^^^^^^^^^^^^
  File "/project/swabhas_1457/ctli/cm/544-nlp-project/official_finetuning/venv/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 560, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/swabhas_1457/ctli/cm/544-nlp-project/official_finetuning/venv/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3055, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/project/swabhas_1457/ctli/cm/544-nlp-project/official_finetuning/venv/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3458, in _map_single
    batch = apply_function_on_filtered_inputs(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/swabhas_1457/ctli/cm/544-nlp-project/official_finetuning/venv/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3320, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/swabhas_1457/ctli/cm/544-nlp-project/official_finetuning/finetune.py", line 112, in <lambda>
    lambda examples: tokenize_dataset(examples, tokenizer, max_length=max_length),
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/swabhas_1457/ctli/cm/544-nlp-project/official_finetuning/finetune.py", line 66, in tokenize_dataset
    tokenized_batch["attention_mask"] = torch.tensor(tokenized_batch["attention_mask"], dtype=torch.int64)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: expected sequence of length 7455 at dim 1 (got 7457)
